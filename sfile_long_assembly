configfile: 'config.yml'

rule all:
    input:
        expand('data/fasta_wgs/{sample}.fasta',sample=config['plasmids'])

rule long_assembly:
    input:
        l='data/fastq/{sample}.fastq'
    output:
        flye=directory('data/flye/{sample}'),
        fasta='data/fasta_wgs/{sample}.fasta'
    conda:
        'bin/env/flye.yml'
    threads: config['threads']
    shell:
        'flye --nano-raw {input} -o {output.flye} -t {threads} &&'
        'cp {output.flye}/assembly.fasta {output.fasta}'